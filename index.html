<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dare to Lose: Starfield</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root { --neon-pink: #ff00ff; --neon-blue: #00f3ff; --engine-orange: #ffcc80; }
        body { font-family: 'Press Start 2P', cursive; touch-action: none; background-color: #000; overflow: hidden; -webkit-tap-highlight-color: transparent; user-select: none; color: white; }
        .scanlines { background: linear-gradient(to bottom, transparent, transparent 50%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.2)); background-size: 100% 4px; pointer-events: none; z-index: 50; }
        
        #menuCanvas { position: absolute; inset: 0; z-index: 0; opacity: 0.8; }

        .title-glow { text-shadow: 3px 3px 0px #ff00de, -2px -2px 0px #00f3ff; }
        .retro-checkbox { appearance: none; width: 18px; height: 18px; border: 2px solid var(--neon-blue); background: black; cursor: pointer; position: relative; margin-right: 10px; vertical-align: middle; }
        .retro-checkbox:checked { background: var(--neon-blue); }
        .retro-checkbox:checked::after { content: 'âœ”'; position: absolute; top: -2px; left: 2px; color: black; font-size: 10px; }
        
        .btn-active { animation: pulse-border 1.5s infinite; }
        @keyframes pulse-border { 0%, 100% { box-shadow: 0 0 5px var(--neon-blue); } 50% { box-shadow: 0 0 15px var(--neon-blue); } }

        #speedBarFill { 
            background: var(--engine-orange); 
            box-shadow: 0 0 10px var(--engine-orange); 
            transition: width 0.4s ease-in-out; 
        }
    </style>
</head>
<body class="h-screen w-screen flex flex-col items-center justify-center">
    <audio id="bgMusic" loop preload="auto"><source src="https://opengameart.org/sites/default/files/loading_0.mp3" type="audio/mpeg"></audio>
    
    <div id="game-container" class="relative w-full h-full max-w-md bg-black shadow-2xl overflow-hidden border-x border-white/5">
        <canvas id="gameCanvas" class="block w-full h-full"></canvas>
        <div class="scanlines absolute inset-0 w-full h-full"></div>

        <div id="hud" class="hidden absolute top-6 left-6 z-20 pointer-events-none">
            <p class="text-[7px] text-gray-500 mb-1 tracking-widest">ENGINE THRUST</p>
            <div class="w-32 h-2 bg-gray-900 border border-white/10 mb-4">
                <div id="speedBarFill" class="h-full" style="width: 0%"></div>
            </div>
            <p class="text-[7px] text-gray-500 mb-1">SCORE</p>
            <p id="scoreDisplay" class="text-xl text-white">0</p>
        </div>

        <div id="startScreen" class="absolute inset-0 z-40 flex flex-col items-center justify-center bg-black px-6">
            <canvas id="menuCanvas"></canvas>
            <div class="relative z-10 text-center mb-10">
                <h1 class="text-4xl text-white title-glow leading-tight tracking-tighter mb-4">DARE<br>TO<br>LOSE</h1>
                <div class="h-1 w-16 bg-neon-pink mx-auto"></div>
            </div>
            <div class="relative z-10 w-full max-w-xs mb-8 bg-black/60 p-6 border border-white/5 rounded-lg backdrop-blur-sm">
                <div class="flex items-center justify-center mb-6">
                    <input type="checkbox" id="agreeCheck" class="retro-checkbox">
                    <label for="agreeCheck" class="text-[9px] text-gray-400 cursor-pointer">I AGREE TO THE <span id="openTcBtn" class="text-neon-pink underline">TERMS & RULES</span></label>
                </div>
                <button id="startBtn" disabled class="w-full py-4 border-2 border-neon-blue text-neon-blue text-[10px] tracking-widest bg-black/80 transition-all">CONNECT SYSTEM</button>
            </div>
            <div class="relative z-10 text-center">
                <p class="text-[8px] text-gray-500 uppercase mb-1 tracking-widest">High Score</p>
                <p id="highScore" class="text-neon-blue text-lg">0</p>
            </div>
        </div>

        <div id="tcModal" class="hidden absolute inset-0 z-50 flex items-center justify-center bg-black/95 p-6 backdrop-blur-md">
            <div class="border-2 border-neon-pink p-6 w-full max-sm bg-gray-900 relative shadow-[0_0_20px_rgba(255,0,255,0.3)]">
                <h2 class="text-neon-pink text-[10px] mb-4 text-center border-b border-gray-700 pb-2">TERMS OF DOOM</h2>
                <div class="text-[9px] text-gray-300 leading-loose space-y-3 mb-6 h-48 overflow-y-auto pr-2">
                    <p>1. By playing, you acknowledge that your skills may be insufficient.</p>
                    <p>2. If you crash, you are bound to perform the randomly generated dare.</p>
                    <p>3. Dares include social awkwardness or physical exercise.</p>
                    <p>4. The algorithm's judgment is final.</p>
                    <p>5. Developers hold no responsibility for dare outcomes as they're chill asf.</p>
                    <p>5. Legal contact: Just Dont :> </p>
                </div>
                <button id="closeTcBtn" class="w-full py-3 bg-neon-pink text-black text-[10px] hover:bg-white transition">I UNDERSTAND</button>
            </div>
        </div>

        <div id="gameOverScreen" class="hidden absolute inset-0 z-40 flex flex-col items-center justify-center bg-black/95 px-8 text-center">
            <h2 class="text-2xl text-red-600 mb-2 title-glow">VOID REACHED</h2>
            <div class="flex gap-4 justify-center mb-6">
                <div><p class="text-[7px] text-gray-500">SCORE</p><p id="finalScore" class="text-white text-lg">0</p></div>
                <div class="border-l border-white/20 pl-4"><p class="text-[7px] text-gray-500">BEST</p><p id="finalBest" class="text-neon-blue text-lg">0</p></div>
            </div>
            <div class="w-full border border-orange-300/30 p-5 mb-6 bg-orange-950/10">
                <p class="text-[8px] text-orange-300 mb-3 uppercase tracking-widest">Penalty Dare</p>
                <p id="dareText" class="text-[10px] leading-relaxed text-white italic"></p>
            </div>
            <div class="flex flex-col gap-3 w-full">
                <button id="restartBtn" class="w-full py-4 border-2 border-white text-white text-[10px] tracking-widest hover:bg-white hover:text-black transition">RE-LAUNCH</button>
                <button id="menuBtn" class="w-full py-3 text-gray-500 text-[8px] tracking-[0.2em] hover:text-white transition uppercase underline">Back to Main Menu</button>
            </div>
        </div>

        <div class="absolute inset-0 z-10 flex">
            <div id="leftZone" class="w-1/2 h-full"></div>
            <div id="rightZone" class="w-1/2 h-full"></div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const menuCanvas = document.getElementById('menuCanvas');
        const mctx = menuCanvas.getContext('2d');
        const music = document.getElementById('bgMusic');
        const dares = ["Do 10 pushups.", "Text your 3rd DM 'I'm a potato'.", "Post a selfie with a spoon.", "15 squats now.", "Text mom 'I love you' randomly.", "45s Plank.", "Spin 10 times then walk straight.", "Lick your elbow for 30s.", "Text crush 'Believe in aliens?'", "Handstand for 15s."];

        let highScore = localStorage.getItem('neonDareHighScore') || 0;
        document.getElementById('highScore').innerText = highScore;

        let score = 0, gameSpeed = 3, isGameOver = false;
        let player = { x: 0, y: 0, w: 24, h: 42 };
        let obstacles = [], stars = [], menuStars = [];
        let moveLeft = false, moveRight = false;

        function resize() {
            canvas.width = canvas.parentElement.offsetWidth; canvas.height = canvas.parentElement.offsetHeight;
            menuCanvas.width = canvas.width; menuCanvas.height = canvas.height;
            initMenuStars();
        }
        window.addEventListener('resize', resize); resize();

        function initMenuStars() {
            menuStars = [];
            for(let i=0; i<45; i++) menuStars.push({x: Math.random()*canvas.width, y: Math.random()*canvas.height, r: Math.random()*1.5, o: Math.random(), s: Math.random()*0.02});
        }

        function drawMenu() {
            if(!document.getElementById('startScreen').classList.contains('hidden')) {
                mctx.clearRect(0,0,canvas.width, canvas.height);
                menuStars.forEach((s, i) => {
                    s.o += s.s; if(s.o > 1 || s.o < 0) s.s *= -1;
                    mctx.fillStyle = `rgba(255,255,255,${s.o})`;
                    mctx.beginPath(); mctx.arc(s.x, s.y, s.r, 0, Math.PI*2); mctx.fill();
                    for(let j=i+1; j<menuStars.length; j++) {
                        let dx = s.x - menuStars[j].x, dy = s.y - menuStars[j].y;
                        let dist = Math.sqrt(dx*dx + dy*dy);
                        if(dist < 70) {
                            mctx.strokeStyle = `rgba(255,255,255,${0.15 * (1 - dist/70)})`;
                            mctx.lineWidth = 0.5;
                            mctx.beginPath(); mctx.moveTo(s.x, s.y); mctx.lineTo(menuStars[j].x, menuStars[j].y); mctx.stroke();
                        }
                    }
                });
                requestAnimationFrame(drawMenu);
            }
        }
        drawMenu();

        document.getElementById('openTcBtn').onclick = (e) => { e.preventDefault(); document.getElementById('tcModal').classList.remove('hidden'); };
        document.getElementById('closeTcBtn').onclick = () => document.getElementById('tcModal').classList.add('hidden');

        document.getElementById('agreeCheck').onchange = e => {
            const btn = document.getElementById('startBtn');
            btn.disabled = !e.target.checked;
            btn.classList.toggle('btn-active', e.target.checked);
        };

        const setMove = (l, r) => { moveLeft = l; moveRight = r; };
        document.getElementById('leftZone').onpointerdown = () => setMove(true, false);
        document.getElementById('leftZone').onpointerup = () => setMove(false, false);
        document.getElementById('rightZone').onpointerdown = () => setMove(false, true);
        document.getElementById('rightZone').onpointerup = () => setMove(false, false);

        function drawGame() {
            if(isGameOver) return;
            ctx.fillStyle = '#000'; ctx.fillRect(0,0,canvas.width, canvas.height);
            stars.forEach(s => {
                ctx.strokeStyle = `rgba(255,255,255,${s.o})`; ctx.lineWidth = s.z;
                ctx.beginPath(); ctx.moveTo(s.x, s.y); ctx.lineTo(s.x, s.y + (gameSpeed * 1.5)); ctx.stroke();
                s.y += s.z * (gameSpeed * 0.7);
                if(s.y > canvas.height) { s.y = -20; s.x = Math.random()*canvas.width; }
            });
            if(moveLeft && player.x > 5) player.x -= 7;
            if(moveRight && player.x < canvas.width - player.w - 5) player.x += 7;
            if(Math.random() < 0.015 + (score * 0.0001)) obstacles.push({x: Math.random()*(canvas.width-30), y: -40, w: 25, h: 25});
            obstacles.forEach((o, i) => {
                o.y += gameSpeed;
                ctx.strokeStyle = '#00f3ff'; ctx.lineWidth = 1.5; ctx.strokeRect(o.x, o.y, o.w, o.h);
                if(player.x < o.x + o.w && player.x + player.w > o.x && player.y < o.y + o.h && player.y + player.h > o.y) endGame();
                if(o.y > canvas.height) { obstacles.splice(i,1); score++; }
            });
            gameSpeed = 3 + (score * 0.1);
            document.getElementById('speedBarFill').style.width = Math.min((gameSpeed - 3) * 12, 100) + '%';
            document.getElementById('scoreDisplay').innerText = score;
            ctx.save(); ctx.translate(player.x + player.w/2, player.y + player.h/2);
            ctx.rotate(moveLeft ? -0.2 : (moveRight ? 0.2 : 0));
            ctx.fillStyle = Math.random() > 0.5 ? '#ffcc80' : '#ff9800';
            ctx.beginPath(); ctx.moveTo(-4, 18); ctx.lineTo(0, 18 + (15 * (gameSpeed/3))); ctx.lineTo(4, 18); ctx.fill();
            ctx.fillStyle = '#fff'; ctx.fillRect(-7, -12, 14, 25);
            ctx.beginPath(); ctx.moveTo(-7, -12); ctx.lineTo(0, -22); ctx.lineTo(7, -12); ctx.fill(); ctx.restore();
            requestAnimationFrame(drawGame);
        }

        function startGame() {
            score = 0; gameSpeed = 3; isGameOver = false; obstacles = []; stars = [];
            player = { x: canvas.width/2 - 12, y: canvas.height - 120, w: 24, h: 42 };
            for(let i=0; i<50; i++) stars.push({x:Math.random()*canvas.width, y:Math.random()*canvas.height, z:Math.random()*2+1, o:Math.random()});
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('gameOverScreen').classList.add('hidden');
            document.getElementById('hud').classList.remove('hidden');
            music.currentTime = 0; music.play().catch(()=>{});
            drawGame();
        }

        function endGame() {
            isGameOver = true; music.pause();
            document.getElementById('hud').classList.add('hidden');
            if(score > highScore) { highScore = score; localStorage.setItem('neonDareHighScore', highScore); }
            document.getElementById('finalScore').innerText = score;
            document.getElementById('finalBest').innerText = highScore;
            document.getElementById('highScore').innerText = highScore;
            document.getElementById('dareText').innerText = dares[Math.floor(Math.random()*dares.length)];
            document.getElementById('gameOverScreen').classList.remove('hidden');
        }
        function backToMenu() {
            isGameOver = true;
            music.pause();
            document.getElementById('gameOverScreen').classList.add('hidden');
            document.getElementById('hud').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
            ctx.clearRect(0, 0, canvas.width, canvas.height); 
            drawMenu(); 
        }

        document.getElementById('startBtn').onclick = startGame;
        document.getElementById('restartBtn').onclick = startGame;
        document.getElementById('menuBtn').onclick = backToMenu;
    </script>
</body>
</html>

